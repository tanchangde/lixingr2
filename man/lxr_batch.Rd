% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/batch.R
\name{lxr_batch}
\alias{lxr_batch}
\title{Batch Request Helper}
\usage{
lxr_batch(
  stock_codes,
  fn,
  batch_size = 100L,
  delay = 0.1,
  max_retries = 2L,
  .progress = TRUE,
  ...
)
}
\arguments{
\item{stock_codes}{Character vector of stock codes.}

\item{fn}{API function to call (e.g., \code{lxr_cn_com}).}

\item{batch_size}{Maximum codes per request (default: 100).}

\item{delay}{Delay between requests in seconds (default: 0.1).}

\item{max_retries}{Maximum retry attempts per failed batch (default: 2).}

\item{.progress}{Show progress bar (default: TRUE).}

\item{...}{Additional arguments passed to \code{fn}.}
}
\value{
A tibble combining all batch results.
}
\description{
Automatically splits large stock code requests into batches to handle
API limitations (max 100 codes per request).
}
\section{Supported Functions}{

This function only works with API functions that:
\itemize{
\item Accept a \code{stock_codes} parameter (plural, not \code{stock_code})
\item Support querying multiple stock codes in a single request
}

Compatible functions include: \code{lxr_cn_com}, \code{lxr_cn_com_profile},
\verb{lxr_cn_com_fundmtl_*}, \verb{lxr_cn_com_fs_*}, \verb{lxr_cn_com_hot_*},
\code{lxr_hk_com}, \verb{lxr_hk_com_fundmtl_*}, etc.

Functions using \code{stock_code} (singular) like \code{lxr_cn_com_candlestick}
are NOT supported.
}

\section{Return Format}{

This function always returns a tibble by forcing \code{return_format = "tibble"}.
Any \code{return_format} specified in \code{options} will be overridden.
If you need other formats (\code{json}, \code{list}, \code{resp}), iterate over chunks manually.
}

\examples{
\dontrun{
# Query 500 stocks
codes <- sprintf("\%06d", 1:500)
result <- lxr_batch(
  stock_codes = codes,
  fn = lxr_cn_com
)
}
}
